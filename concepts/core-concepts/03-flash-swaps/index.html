<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Manekiswap - Knowledge base RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Manekiswap - Knowledge base Atom Feed"><title data-react-helmet="true">Flash Swaps | Manekiswap - Knowledge base</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://info.manekiswap.com/concepts/core-concepts/03-flash-swaps"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Flash Swaps | Manekiswap - Knowledge base"><meta data-react-helmet="true" name="description" content="Uniswap flash swapsÂ allow you to withdraw up to the full reserves of any ERC20 token on Uniswap and execute arbitrary logic at no upfront cost, provided that by the end of the transaction you either:"><meta data-react-helmet="true" property="og:description" content="Uniswap flash swapsÂ allow you to withdraw up to the full reserves of any ERC20 token on Uniswap and execute arbitrary logic at no upfront cost, provided that by the end of the transaction you either:"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://info.manekiswap.com/concepts/core-concepts/03-flash-swaps"><link data-react-helmet="true" rel="alternate" href="https://info.manekiswap.com/concepts/core-concepts/03-flash-swaps" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://info.manekiswap.com/concepts/core-concepts/03-flash-swaps" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c9a9c9c8.css">
<link rel="preload" href="/assets/js/runtime~main.81c62476.js" as="script">
<link rel="preload" href="/assets/js/main.70979045.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Manekiswap Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="Manekiswap Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Manekiswap</b></a><a class="navbar__item navbar__link navbar__link--active" href="/">Document</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/manekiswap/manekiswap.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Protocol Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Core Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/core-concepts/01-swaps">Swaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/core-concepts/02-pools">Pools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/concepts/core-concepts/03-flash-swaps">Flash Swaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/core-concepts/04-oracles">Oracles</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Advanced Topics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Governance</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Technical Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Flash Swaps</h1></header><p>Uniswap flash swapsÂ allow you to withdraw up to the full reserves of any ERC20 token on Uniswap and execute arbitrary logic at no upfront cost, provided that by the end of the transaction you either:</p><ul><li>pay for the withdrawn ERC20 tokens with the corresponding pair tokens</li><li>return the withdrawn ERC20 tokens along with a small fee</li></ul><p>Flash swaps are incredibly useful because they obviate upfront capital requirements and unnecessary order-of-operations constraintsÂ for multi-step transactions involving Uniswap.</p><header><h1>Examples</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="capital-free-arbitrage">Capital Free Arbitrage<a aria-hidden="true" class="hash-link" href="#capital-free-arbitrage" title="Direct link to heading">â€‹</a></h2><p>One particularly interesting use case for flash swaps is capital-freeÂ arbitrage. It&#x27;s well-known that an integral part of Uniswap&#x27;s design is to create incentives for arbitrageurs to trade the Uniswap price to a &quot;fair&quot; market price. While game-theoretically sound, this strategy is accessible only to those with sufficient capital to take advantage of arbitrage opportunities. Flash swaps remove this barrier entirely, effectively democratizing arbitrage.</p><p>Imagine a scenario where the cost of buying 1 ETH on Uniswap is 200 DAI (which is calculated by calling <code>getAmountIn</code> with 1 ETH specified as an exact output), and on Oasis (or any other trading venue), 1 ETH buys 220 DAI. To anyone with 200 DAI available, this situation represents a risk-free profit of 20 DAI. Unfortunately, you may not have 200 DAI lying around. With flash swaps, however, this risk-free profit is available for anyone to take as long as they&#x27;re able to pay gas fees.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="withdrawing-eth-from-uniswap">Withdrawing ETH from Uniswap<a aria-hidden="true" class="hash-link" href="#withdrawing-eth-from-uniswap" title="Direct link to heading">â€‹</a></h3><p>The first step is to <em>optimistically</em> withdraw 1 ETH from Uniswap via a flash swap. This will serve as the capital that we use to execute our arbitrage. Note that in this scenario, we&#x27;re assuming that:</p><ul><li>1 ETH is the pre-calculated profit-maximizing trade</li><li>The price has not changed on Uniswap or Oasis since our calculation</li></ul><p>It may be the case that we&#x27;d like to calculate the profit-maximizing trade on-chain at the moment of execution, which is robust to price movements. This can be somewhat complex, depending on the strategy being executed. However, one common strategy is trading as profitably as possible <em>against a fixed external price</em>. (This price may be e.g., the average execution price of one or more orders on Oasis.) If the Uniswap market price is far enough above or below this external price, the following example contains code that calculates the amount to trade over Uniswap for maximum profit: <a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleSwapToPrice.sol" target="_blank" rel="noopener noreferrer"><code>ExampleSwapToPrice.sol</code></a>.</p><div href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/examples/ExampleSwapToPrice.sol">ExampleSwapToPrice.sol</div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="trade-at-external-venue">Trade at External Venue<a aria-hidden="true" class="hash-link" href="#trade-at-external-venue" title="Direct link to heading">â€‹</a></h3><p>Once we&#x27;ve obtained our temporary capital of 1 ETH from Uniswap, we now can trade this for 220 DAI on Oasis. Once we&#x27;ve received the DAI, we need to pay Uniswap back. We&#x27;ve mentioned that the amount required to cover 1 ETH is 200 DAI, calculated via <code>getAmountIn</code>. So, after sending 200 of the DAI back to the Uniswap pair, you&#x27;re left with 20 DAI of profit!</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="instant-leverage">Instant Leverage<a aria-hidden="true" class="hash-link" href="#instant-leverage" title="Direct link to heading">â€‹</a></h2><p>Flash swaps can be used to improve the efficiency of levering up using lending protocols and Uniswap.</p><p>Consider Maker in its simplest form: a system which accepts ETH as collateral and allows DAI to be minted against it while ensuring that the value of the ETH never drops below 150% of the value of the DAI.</p><p>Say we use this system to deposit a principal amount of 3 ETH, and mint the maximum amount of DAI. At a price of 1 ETH / 200 DAI, we receive 400 DAI. In theory, we could lever this position up by selling the DAI for more ETH, depositing this ETH, minting the maximum amount of DAI (which would be less this time), and repeating until we&#x27;ve reached our desired leverage level.</p><p>It&#x27;s quite simple to use Uniswap as a liquidity source for the DAI-to-ETH component of this process. However, looping through protocols in this way isn&#x27;t particularly elegant, and can be gas-intensive.</p><p>Luckily, flash swaps enable us to withdraw the <em>full</em> ETH amount upfront. If we wanted 2x leverage against our 3 ETH principal, we could simply request 3 ETH in a flash swap and deposit 6 ETH into Maker. This gives us the ability to mint 800 DAI. If we mint as much as we need to cover our flash swap (say 605), the remainder serves as a safety margin against price movements.</p><header><h1>Developer resources</h1></header><ul><li>To see how to integrate a flash swap in your smart contract read <a href="/guides/smart-contract-integration/05-using-flash-swaps">Using Flash Swaps</a>.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/flash-swaps">flash-swaps</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/documentation">documentation</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/manekiswap/manekiswap.github.io/edit/master/docs/concepts/02-core-concepts/03-flash-swaps.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/concepts/core-concepts/02-pools"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Pools</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/concepts/core-concepts/04-oracles"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Oracles<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#capital-free-arbitrage" class="table-of-contents__link toc-highlight">Capital Free Arbitrage</a><ul><li><a href="#withdrawing-eth-from-uniswap" class="table-of-contents__link toc-highlight">Withdrawing ETH from Uniswap</a></li><li><a href="#trade-at-external-venue" class="table-of-contents__link toc-highlight">Trade at External Venue</a></li></ul></li><li><a href="#instant-leverage" class="table-of-contents__link toc-highlight">Instant Leverage</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://t.me/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Manekiswap, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.81c62476.js"></script>
<script src="/assets/js/main.70979045.js"></script>
</body>
</html>