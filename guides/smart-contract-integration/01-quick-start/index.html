<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Manekiswap - Knowledge base RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Manekiswap - Knowledge base Atom Feed"><title data-react-helmet="true">Smart Contract Quick start | Manekiswap - Knowledge base</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://info.manekiswap.com/guides/smart-contract-integration/01-quick-start"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Smart Contract Quick start | Manekiswap - Knowledge base"><meta data-react-helmet="true" name="description" content="Developing smart contracts for Ethereum involves a bevy of off-chain tools used for producing and testing bytecode"><meta data-react-helmet="true" property="og:description" content="Developing smart contracts for Ethereum involves a bevy of off-chain tools used for producing and testing bytecode"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://info.manekiswap.com/guides/smart-contract-integration/01-quick-start"><link data-react-helmet="true" rel="alternate" href="https://info.manekiswap.com/guides/smart-contract-integration/01-quick-start" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://info.manekiswap.com/guides/smart-contract-integration/01-quick-start" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c9a9c9c8.css">
<link rel="preload" href="/assets/js/runtime~main.81c62476.js" as="script">
<link rel="preload" href="/assets/js/main.70979045.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Manekiswap Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="Manekiswap Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Manekiswap</b></a><a class="navbar__item navbar__link navbar__link--active" href="/">Document</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/manekiswap/manekiswap.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Interface Integration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Javascript SDK</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Smart Contract Integration</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/smart-contract-integration/01-quick-start">Smart Contract Quick start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/02-trading-from-a-smart-contract">Implement a Swap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/03-providing-liquidity">Providing Liquidity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/04-building-an-oracle">Building an Oracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/05-using-flash-swaps">Flash Swaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/06-getting-pair-addresses">Pair Addresses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/smart-contract-integration/07-supporting-meta-transactions">Supporting meta transactions</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Technical Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Smart Contract Quick start</h1></header><p>Developing smart contracts for Ethereum involves a bevy of off-chain tools used for producing and testing bytecode
that runs on the <a href="https://eth.wiki/en/concepts/evm/ethereum-virtual-machine-(evm)-awesome-list" target="_blank" rel="noopener noreferrer">Ethereum Virtual Machine (EVM)</a>.
Some tools also include workflows for deploying this bytecode to the Ethereum network and testnets.
There are many options for these tools. This guide walks you through writing and testing a simple smart contract that
interacts with the Uniswap Protocol using one specific set of tools (<code>truffle</code> + <code>npm</code> + <code>mocha</code>).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="requirements">Requirements<a aria-hidden="true" class="hash-link" href="#requirements" title="Direct link to heading">â€‹</a></h2><p>To follow this guide, you must have the following installed:</p><ul><li><a href="https://nodejs.org/en/" target="_blank" rel="noopener noreferrer">nodejs &gt;= v12.x &amp; npm &gt;= 6.x</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-a-project">Bootstrapping a project<a aria-hidden="true" class="hash-link" href="#bootstrapping-a-project" title="Direct link to heading">â€‹</a></h2><p>You can start from scratch, but it&#x27;s easier to use a tool like <code>truffle</code> to bootstrap an empty project.
Create an empty directory and run <code>npx truffle init</code> inside that directory to unbox the default
<a href="https://www.trufflesuite.com/boxes" target="_blank" rel="noopener noreferrer">Truffle box</a>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npx truffle init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setting-up-npm">Setting up npm<a aria-hidden="true" class="hash-link" href="#setting-up-npm" title="Direct link to heading">â€‹</a></h2><p>In order to reference the Uniswap V2 contracts, you should use the npm artifacts we deploy containing the core and
periphery smart contracts and interfaces. To add npm dependencies, we first initialize the npm package.
We can run <code>npm init</code> in the same directory to create a <code>package.json</code> file. You can accept all the defaults and
change it later.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="adding-dependencies">Adding dependencies<a aria-hidden="true" class="hash-link" href="#adding-dependencies" title="Direct link to heading">â€‹</a></h2><p>Now that we have an npm package, we can add our dependencies. Let&#x27;s add both the
<a href="https://www.npmjs.com/package/@uniswap/v2-core" target="_blank" rel="noopener noreferrer"><code>@uniswap/v2-core</code></a> and
<a href="https://www.npmjs.com/package/@uniswap/v2-periphery" target="_blank" rel="noopener noreferrer"><code>@uniswap/v2-periphery</code></a> packages.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i --save @uniswap/v2-core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i --save @uniswap/v2-periphery</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you check the <code>node_modules/@uniswap</code> directory, you can now find the Uniswap V2 contracts. </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">moody@MacBook-Pro ~/I/u/demo</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> node_modules/@uniswap/v2-core/contracts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UniswapV2ERC20.sol    UniswapV2Pair.sol     libraries/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UniswapV2Factory.sol  interfaces/           test/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">moody@MacBook-Pro ~/I/u/demo</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> node_modules/@uniswap/v2-periphery/contracts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UniswapV2Migrator.sol  examples/              test/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UniswapV2Router01.sol  interfaces/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UniswapV2Router02.sol  libraries/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>These packages include both the smart contract source code and the build artifacts.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="writing-our-contract">Writing our contract<a aria-hidden="true" class="hash-link" href="#writing-our-contract" title="Direct link to heading">â€‹</a></h2><p>We can now get started writing our example contract.
For writing Solidity, we recommend IntelliJ or VSCode with a solidity plugin, but you can use any text editor.
Let&#x27;s write a contract that returns the value of some amount of liquidity shares for a given token pair.
First create a couple of files:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> contracts/interfaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> contracts/interfaces/ILiquidityValueCalculator.sol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> contracts/LiquidityValueCalculator.sol</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will be the interface of the contract we implement. Put it in <code>contracts/interfaces/ILiquidityValueCalculator.sol</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.6.6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface ILiquidityValueCalculator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function computeLiquidityShareValue(uint liquidity, address tokenA, address tokenB) external returns (uint tokenAAmount, uint tokenBAmount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now let&#x27;s start with the constructor. You need to know where the <code>UniswapV2Factory</code> is deployed in order to compute the
address of the pair and look up the total supply of liquidity shares, plus the amounts for the reserves.
We can store this as an address passed to the constructor.</p><p>The factory address is constant on mainnet and all testnets, so it may be tempting to make this value a constant in your contract,
but since we need to unit test the contract it should be an argument. You can use solidity immutables to save on gas
when accessing this variable.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.6.6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;./interfaces/ILiquidityValueCalculator.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract LiquidityValueCalculator is ILiquidityValueCalculator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public factory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(address factory_) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        factory = factory_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now we need to be able to look up the total supply of liquidity for a pair, and its token balances.
Let&#x27;s put this in a separate function. To implement it, we must:</p><ol><li>Look up the pair address</li><li>Get the reserves of the pair</li><li>Get the total supply of the pair liquidity</li><li>Sort the reserves in the order of tokenA, tokenB </li></ol><p>The <a href="/reference/smart-contracts/library"><code>UniswapV2Library</code></a> has some helpful methods for this.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.6.6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;./interfaces/ILiquidityValueCalculator.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;@uniswap/v2-periphery/contracts/libraries/UniswapV2Library.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;@uniswap/v2-core/contracts/interfaces/IUniswapV2Pair.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract LiquidityValueCalculator is ILiquidityValueCalculator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function pairInfo(address tokenA, address tokenB) internal view returns (uint reserveA, uint reserveB, uint totalSupply) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IUniswapV2Pair pair = IUniswapV2Pair(UniswapV2Library.pairFor(factory, tokenA, tokenB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalSupply = pair.totalSupply();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (uint reserves0, uint reserves1,) = pair.getReserves();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (reserveA, reserveB) = tokenA == pair.token0() ? (reserves0, reserves1) : (reserves1, reserves0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Finally we just need to compute the share value. We will leave that as an exercise to the reader.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.6.6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;./interfaces/ILiquidityValueCalculator.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;@uniswap/v2-periphery/contracts/libraries/UniswapV2Library.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;@uniswap/v2-core/contracts/interfaces/IUniswapV2Pair.sol&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract LiquidityValueCalculator is ILiquidityValueCalculator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address public factory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(address factory_) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        factory = factory_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function pairInfo(address tokenA, address tokenB) internal view returns (uint reserveA, uint reserveB, uint totalSupply) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IUniswapV2Pair pair = IUniswapV2Pair(UniswapV2Library.pairFor(factory, tokenA, tokenB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalSupply = pair.totalSupply();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (uint reserves0, uint reserves1,) = pair.getReserves();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (reserveA, reserveB) = tokenA == pair.token0() ? (reserves0, reserves1) : (reserves1, reserves0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function computeLiquidityShareValue(uint liquidity, address tokenA, address tokenB) external override returns (uint tokenAAmount, uint tokenBAmount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        revert(&#x27;TODO&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="writing-tests">Writing tests<a aria-hidden="true" class="hash-link" href="#writing-tests" title="Direct link to heading">â€‹</a></h2><p>In order to test your contract, you need to:</p><ol><li>Bring up a testnet</li><li>Deploy the <code>UniswapV2Factory</code></li><li>Deploy at least 2 ERC20 tokens for a pair</li><li>Create a pair for the factory</li><li>Deploy your <code>LiquidityValueCalculator</code> contract</li><li>Call <code>LiquidityValueCalculator#computeLiquidityShareValue</code></li><li>Verify the result with an assertion</li></ol><p>#<!-- -->1 is handled for you automatically by the <code>truffle test</code> command.</p><p>Note you should only deploy the precompiled Uniswap contracts in the <code>build</code> directories for unit tests.
This is because solidity appends a metadata hash to compiled contract artifacts which includes the hash of the contract
source code path, and compilations on other machines will not result in the exact same bytecode.
This is problematic because in Uniswap V2 we use the hash of the bytecode in the v2-periphery
<a href="https://github.com/Uniswap/uniswap-v2-periphery/blob/master/contracts/libraries/UniswapV2Library.sol#L24" target="_blank" rel="noopener noreferrer"><code>UniswapV2Library</code></a>,
to compute the pair address.</p><p>To get the bytecode for deploying UniswapV2Factory, you can import the file via:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">UniswapV2FactoryBytecode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@uniswap/v2-core/build/UniswapV2Factory.json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bytecode</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We recommend using a standard ERC20 from <code>@openzeppelin/contracts</code> for deploying an ERC20.</p><p>You can read more about deploying contracts and writing tests using Truffle
<a href="https://www.trufflesuite.com/docs/truffle/testing/writing-tests-in-javascript" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="compiling-and-deploying-the-contract">Compiling and deploying the contract<a aria-hidden="true" class="hash-link" href="#compiling-and-deploying-the-contract" title="Direct link to heading">â€‹</a></h2><p>Learn more about compiling and deploying contracts using Truffle
<a href="https://www.trufflesuite.com/docs/truffle/getting-started/compiling-contracts" target="_blank" rel="noopener noreferrer">here</a> and
<a href="https://www.trufflesuite.com/docs/truffle/getting-started/running-migrations" target="_blank" rel="noopener noreferrer">here</a> respectively.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="wip">WIP<a aria-hidden="true" class="hash-link" href="#wip" title="Direct link to heading">â€‹</a></h2><p>This guide is a WIP. Please contribute to this guide with the edit button below!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/smart-contract-integration">smart contract integration</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/documentation">documentation</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/quick-start">quick start</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/manekiswap/manekiswap.github.io/edit/master/docs/guides/smart-contract-integration/01-quick-start.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/guides/javascript-sdk/05-getting-pair-addresses"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Pair Addresses</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/guides/smart-contract-integration/02-trading-from-a-smart-contract"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Implement a Swap<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#bootstrapping-a-project" class="table-of-contents__link toc-highlight">Bootstrapping a project</a></li><li><a href="#setting-up-npm" class="table-of-contents__link toc-highlight">Setting up npm</a></li><li><a href="#adding-dependencies" class="table-of-contents__link toc-highlight">Adding dependencies</a></li><li><a href="#writing-our-contract" class="table-of-contents__link toc-highlight">Writing our contract</a></li><li><a href="#writing-tests" class="table-of-contents__link toc-highlight">Writing tests</a></li><li><a href="#compiling-and-deploying-the-contract" class="table-of-contents__link toc-highlight">Compiling and deploying the contract</a></li><li><a href="#wip" class="table-of-contents__link toc-highlight">WIP</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://t.me/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/manekiswap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Manekiswap, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.81c62476.js"></script>
<script src="/assets/js/main.70979045.js"></script>
</body>
</html>